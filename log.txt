
## Run locally
sam local invoke MyFunction -e event.json

(the script has known issues, but the foundation works).


aws configure
aws iam create-role --role-name lambda-exec-role --assume-role-policy-document '{"Version": "2012-10-17","Statement": [{ "Effect": "Allow", "Principal": {"Service": "lambda.amazonaws.com"}, "Action": "sts:AssumeRole"}]}'
aws iam attach-role-policy --role-name lambda-exec-role --policy-arn arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole

aws sts get-caller-identity

aws lambda create-function --function-name my-nodejs-function \
--zip-file fileb://function.zip --handler index.handler --runtime nodejs18.x \
--role arn:aws:iam::{ACCOUNT-ID}:role/lambda-exec-role

Update the function if you make changes:

zip -r function.zip .
aws lambda update-function-code --function-name my-nodejs-function --zip-file fileb://function.zip

## deploy also works, we can wrap it in CI/CD.


Tune options to run:

aws lambda update-function-configuration \
    --function-name my-nodejs-function \
    --handler run.handler

aws lambda update-function-configuration \
    --function-name my-nodejs-function \
    --memory-size 256

## 15m, maximum for AWS
aws lambda update-function-configuration \
    --function-name my-nodejs-function \
    --timeout 900


## invoke via CLI
aws lambda invoke --function-name my-nodejs-function --payload '{}' response.json

# it works, but logs appear with a little delay.
